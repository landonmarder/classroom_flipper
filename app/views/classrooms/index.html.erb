<h1 class="aligncenter">Manage Your Classrooms</h1>

<% if current_user.is_teacher? %>
  <p>You have <%= pluralize(@classrooms.length, "classroom")%>.</p>
  <table class="aligncenter">
    <thead>
      <th>Class Name</th>
      <th>Description</th>
      <th>Actions</th>
    </thead>
    <tbody>
      <% @classrooms.each do |classroom| %>
      <tr>
        <td><%=classroom.name%></td>
        <td><%=classroom.description%></td>
        <td><%= link_to 'More Info', classroom %> | <%= link_to 'Edit', edit_classroom_path(classroom) %> |
        <%= link_to 'Delete', classroom, method: :delete, confirm: 'Are you sure you want to delete the classroom? This cannot be undone.' %></td>
      </tr>
      <% end %>
    </tbody>
  </table>
  <h4><%= link_to 'Create Classroom', new_classroom_path%></h4>

<% else %>
  <h1>My Classes</h1>
  <p>You are enrolled in <%= pluralize(@student_enrollments.length, "classroom")%>.</p>
  <table class="aligncenter">
    <thead>
      <td>Name</td>
      <td>Description</td>
      <td>Teacher</td>
    </thead>
    <tbody>
    <% @student_enrollments.each do |enrollment| %>
      <tr>
        <td><%= enrollment.name%></td>
        <td><%= enrollment.description%></td>
        <td><%= enrollment.user.professional_name %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
  <br>
  <h1>Enroll in a Classroom</h1>
  <%= search_form_for @search do |f| %>
    <div class="field small-4 columns">
      <%= f.label :name_cont, "Classroom Name" %>
      <%= f.text_field :name_cont %>
    </div>
    <div class="actions"><%= f.submit "Search"%></div>
  <% end %>

  <table class="aligncenter" id="search-results">
    <thead>
      <th>Class Name</th>
      <th>Description</th>
      <th>Teacher</th>
      <th>Enroll</th>
    </thead>
    <tbody>
        <% @classrooms.each do |classroom| %>
        <tr id='classroom_<%= classroom.id %>'>
          <td><%=classroom.name%></td>
          <td><%=classroom.description%></td>
          <td><%=classroom.user.professional_name %></td>
          <td>
            <% if classroom.enrolled?(current_user) %>
            Enrolled
            <% else %>
            <%= button_to '+', enrollments_path(classroom_id: classroom.id) %>
            <% end %>
          </td>
        </tr>
        <% end %>
    </tbody>
  </table>

<% end %>
